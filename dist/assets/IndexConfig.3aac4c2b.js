var e=Object.defineProperty,l=Object.prototype.hasOwnProperty,o=Object.getOwnPropertySymbols,r=Object.prototype.propertyIsEnumerable,a=(l,o,r)=>o in l?e(l,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):l[o]=r,t=(e,t)=>{for(var n in t||(t={}))l.call(t,n)&&a(e,n,t[n]);if(o)for(var n of o(t))r.call(t,n)&&a(e,n,t[n]);return e};import{h as n}from"./index.b19e3486.js";import{Z as i,r as d,t as u,p as s,d as c,_ as p,b as m,e as g,f,g as b,h,w as y,k as C,u as F,a3 as v,o as k,l as _,a6 as w,a7 as x,j as T,a8 as V}from"./vendor.0469baee.js";const S={name:"DialogAddHotGood",props:{type:String,configType:Number,reload:Function},setup(e){const l=i(null),o=d({visible:!1,ruleForm:{name:"",link:"",id:"",sort:""},rules:{name:[{required:"true",message:"名称不能为空",trigger:["change"]}],id:[{required:"true",message:"编号不能为空",trigger:["change"]}],sort:[{required:"true",message:"排序不能为空",trigger:["change"]}]},id:""});return t(t({},u(o)),{open:e=>{o.visible=!0,e?(o.id=e,(e=>{m.get(`/indexConfigs/${e}`).then((e=>{o.ruleForm={name:e.configName,id:e.goodsId,link:e.redirectUrl,sort:e.configRank}}))})(e)):o.ruleForm={name:"",id:"",link:"",sort:""}},close:()=>{o.visible=!1},formRef:l,submitForm:()=>{l.value.validate((l=>{if(l){if(n(o.ruleForm.name)||n(o.ruleForm.link))return void p.error("不要输入表情包，再输入就打死你个龟孙儿~");if(o.ruleForm.sort<0||o.ruleForm.sort>200)return void p.error("排序值不能小于 0 或大于 200");"add"==e.type?m.post("/indexConfigs",{configType:e.configType||3,configName:o.ruleForm.name,redirectUrl:o.ruleForm.link,goodsId:o.ruleForm.id,configRank:o.ruleForm.sort}).then((()=>{p.success("添加成功"),o.visible=!1,e.reload&&e.reload()})):m.put("/indexConfigs",{configId:o.id,configType:e.configType||3,configName:o.ruleForm.name,redirectUrl:o.ruleForm.link,goodsId:o.ruleForm.id,configRank:o.ruleForm.sort}).then((()=>{p.success("修改成功"),o.visible=!1,e.reload&&e.reload()}))}}))}})}},I=y();s("data-v-284d9796");const P={class:"dialog-footer"},D=C("取 消"),U=C("确 定");c();const z=I(((e,l,o,r,a,t)=>{const n=g("el-input"),i=g("el-form-item"),d=g("el-form"),u=g("el-button"),s=g("el-dialog");return f(),b(s,{title:"add"==o.type?"添加商品":"修改商品",modelValue:e.visible,"onUpdate:modelValue":l[6]||(l[6]=l=>e.visible=l),width:"400px"},{footer:I((()=>[h("span",P,[h(u,{onClick:l[5]||(l[5]=l=>e.visible=!1)},{default:I((()=>[D])),_:1}),h(u,{type:"primary",onClick:r.submitForm},{default:I((()=>[U])),_:1},8,["onClick"])])])),default:I((()=>[h(d,{model:e.ruleForm,rules:e.rules,ref:"formRef","label-width":"100px",class:"good-form"},{default:I((()=>[h(i,{label:"商品名称",prop:"name"},{default:I((()=>[h(n,{type:"text",modelValue:e.ruleForm.name,"onUpdate:modelValue":l[1]||(l[1]=l=>e.ruleForm.name=l)},null,8,["modelValue"])])),_:1}),h(i,{label:"跳转链接",prop:"link"},{default:I((()=>[h(n,{type:"text",modelValue:e.ruleForm.link,"onUpdate:modelValue":l[2]||(l[2]=l=>e.ruleForm.link=l)},null,8,["modelValue"])])),_:1}),h(i,{label:"商品编号",prop:"id"},{default:I((()=>[h(n,{type:"number",min:"0",modelValue:e.ruleForm.id,"onUpdate:modelValue":l[3]||(l[3]=l=>e.ruleForm.id=l)},null,8,["modelValue"])])),_:1}),h(i,{label:"排序值",prop:"sort"},{default:I((()=>[h(n,{type:"number",modelValue:e.ruleForm.sort,"onUpdate:modelValue":l[4]||(l[4]=l=>e.ruleForm.sort=l)},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])}));S.render=z,S.__scopeId="data-v-284d9796";const O={hot:3,new:4,recommend:5},j={name:"Hot",components:{DialogAddGood:S},setup(){const e=F(),l=v(),o=i(null),r=i(null),a=d({loading:!1,tableData:[],multipleSelection:[],total:0,currentPage:1,pageSize:10,type:"add",configType:3}),n=e.beforeEach((e=>{["hot","new","recommend"].includes(e.name)&&(a.configType=O[e.name],a.currentPage=1,s())}));k((()=>{a.configType=O[l.name],s()})),_((()=>{n()}));const s=()=>{a.loading=!0,m.get("/indexConfigs",{params:{pageNumber:a.currentPage,pageSize:a.pageSize,configType:a.configType}}).then((e=>{a.tableData=e.list,a.total=e.totalCount,a.currentPage=e.currPage,a.loading=!1}))};return t(t({},u(a)),{multipleTable:o,handleSelectionChange:e=>{a.multipleSelection=e},addGood:r,handleAdd:()=>{a.type="add",r.value.open()},handleEdit:e=>{a.type="edit",r.value.open(e)},handleDelete:()=>{a.multipleSelection.length?m.post("/indexConfigs/delete",{ids:a.multipleSelection.map((e=>e.configId))}).then((()=>{p.success("删除成功"),s()})):p.error("请选择项")},handleDeleteOne:e=>{m.post("/indexConfigs/delete",{ids:[e]}).then((()=>{p.success("删除成功"),s()}))},getIndexConfig:s,changePage:e=>{a.currentPage=e,s()}})}},N=y();s("data-v-c24c5f2c");const R={class:"header"},A=C("增加"),G=C("批量删除"),E=h("a",{style:{cursor:"pointer"}},"删除",-1);c();const q=N(((e,l,o,r,a,t)=>{const n=g("el-button"),i=g("el-popconfirm"),d=g("el-table-column"),u=g("el-table"),s=g("el-pagination"),c=g("el-card"),p=g("DialogAddGood"),m=w("loading");return f(),b(V,null,[h(c,{class:"index-container"},{header:N((()=>[h("div",R,[h(n,{type:"primary",size:"small",icon:"el-icon-plus",onClick:r.handleAdd},{default:N((()=>[A])),_:1},8,["onClick"]),h(i,{title:"确定删除吗？",onConfirm:r.handleDelete},{reference:N((()=>[h(n,{type:"danger",size:"small",icon:"el-icon-delete"},{default:N((()=>[G])),_:1})])),_:1},8,["onConfirm"])])])),default:N((()=>[x(h(u,{ref:"multipleTable",data:e.tableData,"tooltip-effect":"dark",style:{width:"100%"},onSelectionChange:r.handleSelectionChange},{default:N((()=>[h(d,{type:"selection",width:"55"}),h(d,{prop:"configName",label:"商品名称"}),h(d,{label:"跳转链接"},{default:N((e=>[h("a",{target:"_blank",href:e.row.redirectUrl},T(e.row.redirectUrl),9,["href"])])),_:1}),h(d,{prop:"configRank",label:"排序值",width:"120"}),h(d,{prop:"goodsId",label:"商品编号",width:"200"}),h(d,{prop:"createTime",label:"添加时间",width:"200"}),h(d,{label:"操作",width:"100"},{default:N((e=>[h("a",{style:{cursor:"pointer","margin-right":"10px"},onClick:l=>r.handleEdit(e.row.configId)},"修改",8,["onClick"]),h(i,{title:"确定删除吗？",onConfirm:l=>r.handleDeleteOne(e.row.configId)},{reference:N((()=>[E])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data","onSelectionChange"]),[[m,e.loading]]),h(s,{background:"",layout:"prev, pager, next",total:e.total,"page-size":e.pageSize,"current-page":e.currentPage,onCurrentChange:r.changePage},null,8,["total","page-size","current-page","onCurrentChange"])])),_:1}),h(p,{ref:"addGood",reload:r.getIndexConfig,type:e.type,configType:e.configType},null,8,["reload","type","configType"])],64)}));j.render=q,j.__scopeId="data-v-c24c5f2c";export default j;
