var e=Object.defineProperty,l=Object.prototype.hasOwnProperty,r=Object.getOwnPropertySymbols,a=Object.prototype.propertyIsEnumerable,t=(l,r,a)=>r in l?e(l,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[r]=a,o=(e,o)=>{for(var n in o||(o={}))l.call(o,n)&&t(e,n,o[n]);if(r)for(var n of r(o))a.call(o,n)&&t(e,n,o[n]);return e};import{u as n,a as s,h as d}from"./index.b19e3486.js";import{Z as i,r as u,t as c,p,d as m,_ as g,b as f,e as h,f as b,g as y,h as v,w as k,k as w,o as _,a6 as C,a7 as S,j as F,a8 as U}from"./vendor.0469baee.js";const j={name:"DialogAddSwiper",props:{type:String,reload:Function},setup(e){const l=i(null),r=u({uploadImgServer:n,token:s("token")||"",visible:!1,ruleForm:{url:"",link:"",sort:""},rules:{url:[{required:"true",message:"图片不能为空",trigger:["change"]}],sort:[{required:"true",message:"排序不能为空",trigger:["change"]}]},id:""});return o(o({},c(r)),{open:e=>{r.visible=!0,e?(r.id=e,(e=>{f.get(`/carousels/${e}`).then((e=>{r.ruleForm={url:e.carouselUrl,link:e.redirectUrl,sort:e.carouselRank}}))})(e)):r.ruleForm={url:"",link:"",sort:""}},close:()=>{r.visible=!1},formRef:l,handleBeforeUpload:e=>{const l=e.name.split(".")[1]||"";if(!["jpg","jpeg","png"].includes(l))return g.error("请上传 jpg、jpeg、png 格式的图片"),!1},handleUrlSuccess:e=>{r.ruleForm.url=e.data||""},submitForm:()=>{console.log(l.value.validate),l.value.validate((l=>{if(l){if(d(r.ruleForm.link))return void g.error("不要输入表情包，再输入就打死你个龟孙儿~");"add"==e.type?f.post("/carousels",{carouselUrl:r.ruleForm.url,redirectUrl:r.ruleForm.link,carouselRank:r.ruleForm.sort}).then((()=>{g.success("添加成功"),r.visible=!1,e.reload&&e.reload()})):f.put("/carousels",{carouselId:r.id,carouselUrl:r.ruleForm.url,redirectUrl:r.ruleForm.link,carouselRank:r.ruleForm.sort}).then((()=>{g.success("修改成功"),r.visible=!1,e.reload&&e.reload()}))}}))}})}},x=k();p("data-v-6c3e84de");const P={key:1,class:"el-icon-plus avatar-uploader-icon"},D={class:"dialog-footer"},I=w("取 消"),V=w("确 定");m();const z=x(((e,l,r,a,t,o)=>{const n=h("el-upload"),s=h("el-form-item"),d=h("el-input"),i=h("el-form"),u=h("el-button"),c=h("el-dialog");return b(),y(c,{title:"add"==r.type?"添加轮播图":"修改轮播图",modelValue:e.visible,"onUpdate:modelValue":l[4]||(l[4]=l=>e.visible=l),width:"400px"},{footer:x((()=>[v("span",D,[v(u,{onClick:l[3]||(l[3]=l=>e.visible=!1)},{default:x((()=>[I])),_:1}),v(u,{type:"primary",onClick:a.submitForm},{default:x((()=>[V])),_:1},8,["onClick"])])])),default:x((()=>[v(i,{model:e.ruleForm,rules:e.rules,ref:"formRef","label-width":"100px",class:"good-form"},{default:x((()=>[v(s,{label:"图片",prop:"url"},{default:x((()=>[v(n,{class:"avatar-uploader",action:e.uploadImgServer,accept:"jpg,jpeg,png",headers:{token:e.token},"show-file-list":!1,"before-upload":a.handleBeforeUpload,"on-success":a.handleUrlSuccess},{default:x((()=>[e.ruleForm.url?(b(),y("img",{key:0,style:{width:"200px",height:"100px",border:"1px solid #e9e9e9"},src:e.ruleForm.url,class:"avatar"},null,8,["src"])):(b(),y("i",P))])),_:1},8,["action","headers","before-upload","on-success"])])),_:1}),v(s,{label:"跳转链接",prop:"link"},{default:x((()=>[v(d,{type:"text",modelValue:e.ruleForm.link,"onUpdate:modelValue":l[1]||(l[1]=l=>e.ruleForm.link=l)},null,8,["modelValue"])])),_:1}),v(s,{label:"排序值",prop:"sort"},{default:x((()=>[v(d,{type:"number",modelValue:e.ruleForm.sort,"onUpdate:modelValue":l[2]||(l[2]=l=>e.ruleForm.sort=l)},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])}));j.render=z,j.__scopeId="data-v-6c3e84de";const O={name:"Swiper",components:{DialogAddSwiper:j},setup(){const e=i(null),l=i(null),r=u({loading:!1,tableData:[],multipleSelection:[],total:0,currentPage:1,pageSize:10,type:"add"});_((()=>{a()}));const a=()=>{r.loading=!0,f.get("/carousels",{params:{pageNumber:r.currentPage,pageSize:r.pageSize}}).then((e=>{r.tableData=e.list,r.total=e.totalCount,r.currentPage=e.currPage,r.loading=!1}))};return o(o({},c(r)),{multipleTable:e,handleSelectionChange:e=>{r.multipleSelection=e},addGood:l,handleAdd:()=>{r.type="add",l.value.open()},handleEdit:e=>{r.type="edit",l.value.open(e)},handleDelete:()=>{r.multipleSelection.length?f.delete("/carousels",{data:{ids:r.multipleSelection.map((e=>e.carouselId))}}).then((()=>{g.success("删除成功"),a()})):g.error("请选择项")},handleDeleteOne:e=>{f.delete("/carousels",{data:{ids:[e]}}).then((()=>{g.success("删除成功"),a()}))},getCarousels:a,changePage:e=>{r.currentPage=e,a()}})}},R=k();p("data-v-38f4bf32");const A={class:"header"},E=w("增加"),T=w("批量删除"),q=v("a",{style:{cursor:"pointer"}},"删除",-1);m();const B=R(((e,l,r,a,t,o)=>{const n=h("el-button"),s=h("el-popconfirm"),d=h("el-table-column"),i=h("el-table"),u=h("el-pagination"),c=h("el-card"),p=h("DialogAddSwiper"),m=C("loading");return b(),y(U,null,[v(c,{class:"swiper-container"},{header:R((()=>[v("div",A,[v(n,{type:"primary",size:"small",icon:"el-icon-plus",onClick:a.handleAdd},{default:R((()=>[E])),_:1},8,["onClick"]),v(s,{title:"确定删除吗？",onConfirm:a.handleDelete},{reference:R((()=>[v(n,{type:"danger",size:"small",icon:"el-icon-delete"},{default:R((()=>[T])),_:1})])),_:1},8,["onConfirm"])])])),default:R((()=>[S(v(i,{ref:"multipleTable",data:e.tableData,"tooltip-effect":"dark",style:{width:"100%"},onSelectionChange:a.handleSelectionChange},{default:R((()=>[v(d,{type:"selection",width:"55"}),v(d,{label:"轮播图",width:"200"},{default:R((e=>[v("img",{style:{width:"150px",height:"150px"},src:e.row.carouselUrl,alt:"轮播图"},null,8,["src"])])),_:1}),v(d,{label:"跳转链接"},{default:R((e=>[v("a",{target:"_blank",href:e.row.redirectUrl},F(e.row.redirectUrl),9,["href"])])),_:1}),v(d,{prop:"carouselRank",label:"排序值",width:"120"}),v(d,{prop:"createTime",label:"添加时间",width:"200"}),v(d,{label:"操作",width:"100"},{default:R((e=>[v("a",{style:{cursor:"pointer","margin-right":"10px"},onClick:l=>a.handleEdit(e.row.carouselId)},"修改",8,["onClick"]),v(s,{title:"确定删除吗？",onConfirm:l=>a.handleDeleteOne(e.row.carouselId)},{reference:R((()=>[q])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["data","onSelectionChange"]),[[m,e.loading]]),v(u,{background:"",layout:"prev, pager, next",total:e.total,"page-size":e.pageSize,"current-page":e.currentPage,onCurrentChange:a.changePage},null,8,["total","page-size","current-page","onCurrentChange"])])),_:1}),v(p,{ref:"addGood",reload:a.getCarousels,type:e.type},null,8,["reload","type"])],64)}));O.render=B,O.__scopeId="data-v-38f4bf32";export default O;
